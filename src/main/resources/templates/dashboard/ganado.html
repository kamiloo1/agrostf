<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Gesti√≥n de Ganado | AgroSoft</title>
  <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet">
  <style>
    :root {
      /* Paleta de colores unificada AgroSoft */
      --verde-oscuro: #0d4f3d;
      --verde-med: #1a7a5e;
      --verde-acento: #2d8659;
      --verde-claro: #e8f5f0;
      --verde-suave: #d4edda;
      --gris-fondo: #f5f7fa;
      --gris-borde: #e9ecef;
      --blanco: #ffffff;
      --texto: #1a1a1a;
      --texto-suave: #495057;
      --sombra: rgba(13, 79, 61, 0.15);
      --sombra-suave: rgba(13, 79, 61, 0.08);
      --rojo: #dc3545;
      --amarillo: #ffc107;
      --accent: #fd7e14;
      --azul-verde: #3fa06f;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      min-height: 100vh;
      display: flex;
      background:
        radial-gradient(circle at 12% 18%, var(--verde-claro) 0%, rgba(232, 245, 240, 0.85) 45%, transparent 70%),
        linear-gradient(135deg, var(--gris-fondo) 0%, var(--verde-claro) 50%, #e8f5f0 100%);
      color: var(--texto);
    }

    aside {
      width: 260px;
      background: linear-gradient(162deg, var(--verde-oscuro), #0a3d2d);
      color: #fff;
      padding: 34px 26px;
      display: flex;
      flex-direction: column;
      gap: 26px;
      box-shadow: 18px 0 42px var(--sombra);
      position: sticky;
      top: 0;
      height: 100vh;
    }

    .branding h2 {
      margin: 0;
      font-family: 'Playfair Display', serif;
      font-size: 28px;
      font-style: italic;
      letter-spacing: 0.6px;
    }

    .branding span {
      font-size: 13px;
      opacity: 0.8;
    }

    .user-card {
      background: linear-gradient(145deg, rgba(255,255,255,0.25), rgba(255,255,255,0.06));
      padding: 20px;
      border-radius: 18px;
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.14);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.08);
    }

    .user-card p {
      margin: 0 0 6px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .user-card small {
      opacity: 0.7;
      font-size: 12px;
    }

    nav a {
      display: flex;
      align-items: center;
      gap: 12px;
      color: rgba(255,255,255,0.85);
      text-decoration: none;
      padding: 12px 16px;
      border-radius: 12px;
      font-weight: 500;
      margin-bottom: 6px;
      transition: all 0.3s ease;
    }

    nav a i {
      font-size: 20px;
    }

    nav a:hover,
    nav a.active {
      background: rgba(255,255,255,0.2);
      color: #fff;
      transform: translateX(6px);
      box-shadow: 0 9px 26px rgba(17, 58, 34, 0.22);
    }

    main {
      flex: 1;
      padding: 40px 50px;
      overflow-x: hidden;
    }

    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 24px;
      margin-bottom: 32px;
    }

    .page-header h1 {
      margin: 0;
      font-family: 'Playfair Display', serif;
      font-size: 34px;
      color: var(--verde-oscuro);
    }

    .page-header h1 span {
      display: block;
      font-family: 'Roboto', sans-serif;
      font-size: 16px;
      font-weight: 400;
      color: var(--verde-med);
      margin-top: 4px;
    }

    .header-actions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .header-actions button {
      border: none;
      border-radius: 14px;
      padding: 12px 20px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 10px 26px var(--sombra);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .header-actions button.secondary {
      background: rgba(255,255,255,0.92);
      color: var(--verde-med);
      border: 1px solid var(--gris-borde);
    }

    .header-actions button.primary {
      background: linear-gradient(135deg, var(--verde-med), var(--verde-acento));
      color: #fff;
    }

    .header-actions button:hover {
      transform: translateY(-2px);
      box-shadow: 0 16px 36px rgba(13, 79, 61, 0.2);
    }

    .floating-bubble {
      position: absolute;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(45, 134, 89, 0.18), transparent 70%);
      pointer-events: none;
      animation: floaty 10s ease-in-out infinite;
      z-index: 0;
    }

    .floating-bubble.bubble-1 { top: 12%; left: 8%; width: 140px; height: 140px; animation-delay: 0s; }
    .floating-bubble.bubble-2 { bottom: 16%; right: 6%; width: 180px; height: 180px; animation-delay: 1.6s; }
    .floating-bubble.bubble-3 { top: 38%; right: 18%; width: 110px; height: 110px; animation-delay: 3.2s; }

    @keyframes floaty {
      0%, 100% { transform: translateY(0) scale(1); opacity: 0.55; }
      50% { transform: translateY(-18px) scale(1.08); opacity: 0.8; }
    }

    .celebration-banner {
      position: relative;
      background: linear-gradient(135deg, var(--verde-med), var(--verde-acento));
      border-radius: 28px;
      padding: 28px 32px;
      display: flex;
      flex-wrap: wrap;
      gap: 24px;
      align-items: center;
      color: white;
      box-shadow: 0 28px 46px var(--sombra);
      margin-bottom: 28px;
      overflow: hidden;
    }

    .celebration-banner::after,
    .celebration-banner::before {
      content: '';
      position: absolute;
      width: 180px;
      height: 180px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255,255,255,0.32), transparent 70%);
      z-index: 0;
    }

    .celebration-banner::before { top: -60px; right: -40px; }
    .celebration-banner::after { bottom: -70px; left: -30px; }

    .celebration-banner .badge-fun {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 255, 255, 0.22);
      padding: 6px 16px;
      border-radius: 999px;
      font-weight: 600;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 10px;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.35);
    }

    .celebration-banner .banner-copy {
      flex: 1.2;
      min-width: 240px;
      position: relative;
      z-index: 1;
    }

    .celebration-banner .banner-copy h2 {
      font-size: 26px;
      margin: 6px 0 12px;
      line-height: 1.2;
      letter-spacing: 0.4px;
    }

    .celebration-banner .banner-copy p {
      font-size: 15px;
      opacity: 0.9;
      max-width: 460px;
      line-height: 1.5;
    }

    .celebration-banner .banner-actions {
      display: flex;
      gap: 14px;
      margin-top: 18px;
      flex-wrap: wrap;
    }

    .celebration-banner .banner-actions button {
      border: none;
      border-radius: 18px;
      padding: 10px 18px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      backdrop-filter: blur(6px);
      transition: transform 0.25s ease, box-shadow 0.25s ease, background 0.25s ease;
    }

    .celebration-banner .banner-actions button.primary {
      background: white;
      color: var(--verde-oscuro);
      box-shadow: 0 18px 32px var(--sombra);
    }

    .celebration-banner .banner-actions button:hover {
      transform: translateY(-2px);
      box-shadow: 0 16px 26px var(--sombra);
    }

    .celebration-banner .banner-illustration {
      flex: 0.8;
      min-width: 220px;
      display: grid;
      gap: 12px;
      position: relative;
      z-index: 1;
    }

    .celebration-tile {
      background: rgba(255, 255, 255, 0.18);
      padding: 14px 18px;
      border-radius: 18px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      border: 1px solid rgba(255,255,255,0.28);
      backdrop-filter: blur(8px);
    }

    .celebration-tile strong {
      font-size: 22px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .celebration-tile span {
      font-size: 13px;
      opacity: 0.85;
    }

    .milestones-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 18px;
      margin-bottom: 28px;
    }

    .progress-card {
      background: var(--blanco);
      border-radius: 20px;
      padding: 18px 20px;
      box-shadow: var(--sombra-suave);
      border: 1px solid var(--gris-borde);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .progress-card::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 90% -10%, rgba(45, 134, 89, 0.16), transparent 70%);
      pointer-events: none;
    }

    .progress-card header {
      font-weight: 700;
      font-size: 15px;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      color: var(--verde-oscuro);
      position: relative;
      z-index: 1;
    }

    .progress-card header span {
      font-size: 18px;
      display: inline-flex;
    }

    .progress-card p {
      margin: 0;
      font-size: 13px;
      color: var(--texto-suave);
      position: relative;
      z-index: 1;
    }

    .progress-bar {
      position: relative;
      width: 100%;
      height: 10px;
      border-radius: 999px;
      background: rgba(223, 243, 223, 0.7);
      overflow: hidden;
      margin-top: 6px;
      box-shadow: inset 0 0 0 1px var(--gris-borde);
      z-index: 1;
    }

    .progress-bar span {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 0;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--verde-med), var(--verde-acento));
      transition: width 0.6s ease;
    }

    .progress-card small {
      font-size: 12px;
      color: var(--texto-suave);
      font-weight: 600;
      letter-spacing: 0.4px;
      position: relative;
      z-index: 1;
    }

    .fun-strip {
      background: rgba(255, 255, 255, 0.92);
      border-radius: 24px;
      padding: 18px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 18px;
      box-shadow: var(--sombra-suave);
      border: 1px solid var(--gris-borde);
      margin-bottom: 30px;
      position: relative;
      overflow: hidden;
    }

    .fun-strip::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 12% 40%, rgba(129, 199, 132, 0.18), transparent 70%);
      pointer-events: none;
    }

    .fun-message {
      display: flex;
      align-items: center;
      gap: 14px;
      position: relative;
      z-index: 1;
      color: var(--verde-oscuro);
      font-weight: 600;
      font-size: 15px;
    }

    .fun-message span {
      font-size: 24px;
    }

    #refreshMessage {
      border: none;
      background: var(--verde-claro);
      color: var(--verde-med);
      border-radius: 14px;
      padding: 10px 16px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      z-index: 1;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    #refreshMessage:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 24px var(--sombra);
    }

    .sparkle {
      position: absolute;
      width: 12px;
      height: 12px;
      background: radial-gradient(circle, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0) 70%);
      border-radius: 50%;
      animation: sparkle 4s linear infinite;
      pointer-events: none;
      opacity: 0.7;
      z-index: 1;
    }

    .celebration-banner .sparkle:nth-of-type(1) { top: 12%; left: 28%; animation-delay: 0s; }
    .celebration-banner .sparkle:nth-of-type(2) { top: 66%; left: 12%; animation-delay: 1.2s; }
    .celebration-banner .sparkle:nth-of-type(3) { top: 30%; right: 16%; animation-delay: 2.4s; }

    @keyframes sparkle {
      0%, 100% { transform: scale(0.5); opacity: 0; }
      10% { opacity: 0.8; }
      50% { transform: scale(1.3); opacity: 0.9; }
      90% { opacity: 0; }
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 34px;
    }

    .stat-card {
      position: relative;
      overflow: hidden;
      background: var(--blanco);
      border-radius: 22px;
      padding: 24px 22px;
      box-shadow: var(--sombra);
      border: 1px solid var(--gris-borde);
      display: flex;
      flex-direction: column;
      gap: 10px;
      isolation: isolate;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top right, rgba(101, 182, 122, 0.25), transparent 55%);
      z-index: -1;
    }

    .stat-card header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .stat-card header i {
      font-size: 28px;
      color: var(--verde-med);
      background: rgba(101, 182, 122, 0.12);
      padding: 10px;
      border-radius: 14px;
    }

    .stat-card h3 {
      margin: 0;
      font-size: 14px;
      font-weight: 500;
      color: var(--texto-suave);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .stat-card strong {
      font-size: 32px;
      color: var(--verde-oscuro);
      font-weight: 700;
    }

    .stat-trend {
      font-size: 12px;
      color: var(--texto-suave);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .analytics-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
      margin-bottom: 34px;
    }

    .chart-card {
      position: relative;
      background: var(--blanco);
      border-radius: 24px;
      padding: 26px;
      box-shadow: var(--sombra);
      border: 1px solid var(--gris-borde);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .chart-card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 82% 12%, rgba(45, 134, 89, 0.12), transparent 60%);
      pointer-events: none;
    }

    .chart-card header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      position: relative;
      z-index: 1;
    }

    .chart-card header h4 {
      margin: 0;
      font-size: 18px;
      color: var(--verde-oscuro);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .chart-card header span {
      font-size: 12px;
      color: var(--texto-suave);
    }

    .chart-wrapper {
      position: relative;
      height: 260px;
      width: 100%;
    }

    .chart-wrapper canvas {
      width: 100% !important;
      height: 100% !important;
    }

    .chart-legend {
      display: flex;
      justify-content: flex-start;
      flex-wrap: wrap;
      gap: 10px;
      font-size: 12px;
      color: var(--texto-suave);
      position: relative;
      z-index: 1;
    }

    .chart-legend span {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 12px;
      background: rgba(223, 243, 223, 0.6);
    }

    .chart-legend span i {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      display: inline-block;
    }

    .quick-filters {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 12px;
      margin: 12px 0 26px;
    }

    .quick-filters span {
      font-size: 13px;
      font-weight: 600;
      color: var(--texto-suave);
    }

    .quick-filters .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .quick-filters button {
      border: none;
      border-radius: 999px;
      padding: 8px 14px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      background: var(--verde-claro);
      color: var(--verde-acento);
      box-shadow: var(--sombra-suave);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s ease;
    }

    .quick-filters button.active {
      background: var(--verde-acento);
      color: #fff;
      box-shadow: 0 10px 24px var(--sombra);
    }

    .view-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 8px 0 18px;
      flex-wrap: wrap;
      gap: 14px;
    }

    .view-meta {
      font-size: 12px;
      color: var(--texto-suave);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(223, 243, 223, 0.6);
      padding: 8px 14px;
      border-radius: 14px;
      box-shadow: var(--sombra-suave);
    }

    .toggle-group {
      display: inline-flex;
      background: rgba(223, 243, 223, 0.7);
      padding: 4px;
      border-radius: 999px;
    }

    .toggle-group button {
      border: none;
      padding: 8px 18px;
      border-radius: 999px;
      background: transparent;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      color: var(--verde-acento);
      transition: all 0.2s ease;
    }

    .toggle-group button.active {
      background: var(--verde-acento);
      color: #fff;
      box-shadow: 0 10px 22px var(--sombra);
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }

    .animal-card {
      background: var(--blanco);
      border-radius: 24px;
      padding: 22px;
      box-shadow: var(--sombra);
      border: 1px solid var(--gris-borde);
      display: flex;
      flex-direction: column;
      gap: 16px;
      position: relative;
      overflow: hidden;
    }

    .animal-card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 82% -10%, rgba(45, 134, 89, 0.12), transparent 60%);
      pointer-events: none;
    }

    .animal-card header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      position: relative;
      z-index: 1;
    }

    .animal-card header h5 {
      margin: 0;
      font-size: 18px;
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--verde-oscuro);
    }

    .animal-card header h5 i {
      font-size: 22px;
      color: var(--verde-acento);
      background: rgba(101, 182, 122, 0.16);
      padding: 8px;
      border-radius: 12px;
    }

    .animal-card .meta {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 10px;
      font-size: 13px;
      position: relative;
      z-index: 1;
    }

    .animal-card .meta span {
      display: flex;
      align-items: center;
      gap: 6px;
      color: var(--texto-suave);
    }

    .animal-card .meta span i {
      color: var(--verde-acento);
    }

    .animal-card .footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      position: relative;
      z-index: 1;
    }

    .animal-card .footer .state {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .hidden {
      display: none !important;
    }

    .range-wrapper {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .range-wrapper input[type="range"] {
      flex: 1;
      accent-color: var(--verde-acento);
    }

    .range-wrapper span {
      font-size: 12px;
      color: var(--texto-suave);
      min-width: 58px;
      text-align: right;
    }

    .timeline-section {
      margin-top: 32px;
      background: var(--blanco);
      border-radius: 24px;
      padding: 26px;
      box-shadow: var(--sombra);
      border: 1px solid var(--gris-borde);
      position: relative;
      overflow: hidden;
    }

    .timeline-section::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 90% 10%, rgba(101, 182, 122, 0.12), transparent 60%);
      pointer-events: none;
    }

    .timeline-section h3 {
      margin-top: 0;
      font-size: 20px;
      color: var(--verde-oscuro);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .timeline {
      margin: 20px 0 0;
      border-left: 3px solid rgba(76, 133, 120, 0.18);
      padding-left: 18px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      position: relative;
    }

    .timeline-item {
      position: relative;
      padding-left: 10px;
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: -23px;
      top: 4px;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--verde-acento);
      box-shadow: 0 0 0 4px rgba(101, 182, 122, 0.18);
    }

    .timeline-item header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      font-size: 13px;
      color: var(--texto-suave);
      margin-bottom: 6px;
    }

    .timeline-item strong {
      color: var(--verde-oscuro);
      font-size: 15px;
    }

    .filters-panel {
      background: var(--blanco);
      border-radius: 22px;
      padding: 26px;
      box-shadow: var(--sombra);
      border: 1px solid var(--gris-borde);
      margin-bottom: 32px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 18px;
      position: relative;
      overflow: hidden;
    }

    .filters-panel::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 16% 22%, rgba(101, 182, 122, 0.12), transparent 58%);
      pointer-events: none;
    }

    .filters-panel::after {
      content: 'Filtros din√°micos';
      position: absolute;
      top: -14px;
      left: 24px;
      background: var(--verde-med);
      color: #fff;
      padding: 4px 12px;
      border-radius: 14px;
      font-size: 12px;
      letter-spacing: 0.6px;
      box-shadow: 0 10px 24px rgba(13, 79, 61, 0.2);
    }

    .filters-panel label {
      font-size: 13px;
      font-weight: 600;
      color: rgba(27, 94, 32, 0.76);
      display: block;
      margin-bottom: 6px;
    }

    .filters-panel input,
    .filters-panel select {
      width: 100%;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(46, 125, 50, 0.18);
      background: rgba(255,255,255,0.95);
      font-size: 14px;
      transition: border 0.3s ease, box-shadow 0.3s ease;
    }

    .filters-panel input:focus,
    .filters-panel select:focus {
      outline: none;
      border-color: var(--verde-med);
      box-shadow: 0 0 0 4px rgba(76, 175, 80, 0.2);
    }

    .filters-panel .filter-actions {
      display: flex;
      gap: 12px;
      align-items: flex-end;
      justify-content: flex-end;
    }

    .filters-panel .filter-actions button {
      border: none;
      border-radius: 12px;
      padding: 12px 18px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .filters-panel .filter-actions button.primary {
      background: var(--verde-med);
      color: #fff;
    }

    .filters-panel .filter-actions button.secondary {
      background: rgba(46,125,50,0.12);
      color: var(--verde-med);
    }

    .form-section {
      background: var(--blanco);
      border-radius: 22px;
      padding: 30px;
      box-shadow: var(--sombra);
      border: 1px solid var(--gris-borde);
      margin-bottom: 32px;
      position: relative;
      overflow: hidden;
    }

    .form-section::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 82% 0%, rgba(242, 166, 90, 0.16), transparent 58%);
      pointer-events: none;
    }

    .form-section h3 {
      margin: 0 0 20px;
      color: var(--verde-oscuro);
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 20px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 18px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-group label {
      font-size: 13px;
      font-weight: 600;
      color: rgba(27, 94, 32, 0.8);
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      border-radius: 12px;
      border: 1px solid rgba(46, 125, 50, 0.18);
      padding: 12px 14px;
      font-size: 14px;
      background: rgba(255,255,255,0.95);
      transition: border 0.3s ease, box-shadow 0.3s ease;
    }

    .form-group textarea {
      resize: vertical;
      min-height: 100px;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--verde-med);
      box-shadow: 0 0 0 4px rgba(76, 175, 80, 0.2);
    }

    .form-actions {
      display: flex;
      gap: 12px;
      margin-top: 20px;
    }

    .form-actions button {
      border: none;
      border-radius: 12px;
      padding: 12px 18px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .form-actions button.submit {
      background: var(--verde-med);
      color: #fff;
    }

    .form-actions button.clear {
      background: rgba(46,125,50,0.12);
      color: var(--verde-med);
    }

    .edit-form {
      display: none;
    }

    .table-wrapper {
      background: rgba(255,255,255,0.95);
      border-radius: 24px;
      box-shadow: var(--sombra);
      border: 1px solid rgba(46,125,50,0.12);
      overflow: hidden;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    thead {
      background: linear-gradient(135deg, var(--verde-oscuro), var(--verde-med));
      color: #fff;
    }

    thead th {
      padding: 16px 18px;
      text-align: left;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 500;
    }

    tbody td {
      padding: 15px 18px;
      border-bottom: 1px solid rgba(46,125,50,0.08);
      font-size: 15px;
      vertical-align: middle;
    }

    tbody tr:hover {
      background: rgba(76, 175, 80, 0.08);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 500;
      background: rgba(101, 182, 122, 0.18);
      color: var(--verde-med);
    }

    .badge.inactive {
      background: rgba(209, 73, 91, 0.16);
      color: var(--rojo);
    }

    .health-tag {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 600;
    }

    .health-tag.healthy {
      background: rgba(101, 182, 122, 0.18);
      color: var(--verde-med);
    }

    .health-tag.observe {
      background: rgba(244, 201, 93, 0.22);
      color: var(--amarillo);
    }

    .health-tag.sick {
      background: rgba(209, 73, 91, 0.18);
      color: var(--rojo);
    }

    .actions {
      display: flex;
      gap: 10px;
    }

    .actions button {
      border: none;
      border-radius: 12px;
      padding: 8px 14px;
      cursor: pointer;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .actions button.edit {
      background: rgba(86, 143, 205, 0.16);
      color: #3b74b1;
    }

    .actions button.toggle {
      background: rgba(63, 124, 94, 0.16);
      color: var(--verde-med);
    }

    .actions button.toggle.inactive {
      background: rgba(209, 73, 91, 0.16);
      color: var(--rojo);
    }

    .actions button:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }

    .secondary-section {
      margin-top: 30px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 24px;
    }

    .secondary-card {
      background: var(--blanco);
      border-radius: 22px;
      padding: 24px;
      box-shadow: var(--sombra);
      border: 1px solid var(--gris-borde);
      display: flex;
      flex-direction: column;
      gap: 16px;
      position: relative;
      overflow: hidden;
    }

    .secondary-card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 78% 18%, rgba(76, 133, 120, 0.14), transparent 60%);
      pointer-events: none;
    }

    .secondary-card h4 {
      margin: 0;
      font-size: 18px;
      color: var(--verde-oscuro);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .list-items {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .list-item {
      background: rgba(223, 243, 223, 0.6);
      border-radius: 14px;
      padding: 12px 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .list-item span:first-child {
      font-weight: 600;
      color: var(--verde-med);
    }

    .mini-badge {
      background: rgba(255,255,255,0.9);
      color: var(--verde-med);
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 600;
    }

    @media (max-width: 1100px) {
      aside {
        display: none;
      }
      body {
        padding: 20px;
      }
      main {
        padding: 24px;
      }
      .page-header {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
</head>
<body>

<div class="floating-bubble bubble-1"></div>
<div class="floating-bubble bubble-2"></div>
<div class="floating-bubble bubble-3"></div>

<aside>
  <div class="branding">
    <h2>AgroSoft</h2>
    <span>Gesti√≥n integral de animales</span>
  </div>

  <div class="user-card">
    <p><i class="ri-user-line"></i> <span th:text="${usuario ?: 'Administrador'}">Administrador</span></p>
    <small>Coordinador veterinario</small>
  </div>

  <nav>
    <a th:href="@{/dashboard/administrador}"><i class="ri-dashboard-line"></i>Panel general</a>
    <a th:href="@{/admin/cultivos}"><i class="ri-leaf-line"></i>Cultivos</a>
    <a th:href="@{/admin/ganado}" class="active"><i class="ri-cow-line"></i>Ganado</a>
    <a><i class="ri-calendar-2-line"></i>Agenda sanitaria</a>
    <a th:href="@{/logout}"><i class="ri-logout-circle-line"></i>Cerrar sesi√≥n</a>
  </nav>
</aside>

<main>
  <header class="page-header">
    <div>
      <h1>
        Gesti√≥n de Ganado
        <span>Controla el estado sanitario y la disponibilidad de cada animal</span>
      </h1>
    </div>
    <div class="header-actions">
      <button type="button" class="secondary"><i class="ri-qr-scan-line"></i> Registrar sensor</button>
      <button type="button" class="secondary"><i class="ri-download-line"></i> Exportar informe</button>
      <button type="button" class="primary" id="scrollToForm"><i class="ri-add-line"></i> Nuevo registro</button>
    </div>
  </header>

  <section class="celebration-banner">
    <span class="sparkle"></span>
    <span class="sparkle"></span>
    <span class="sparkle"></span>
    <div class="banner-copy">
      <span class="badge-fun">üåø Ritmo excelente</span>
      <h2>¬°El reba√±o luce feliz hoy!</h2>
      <p>Revisa los animales destacados, celebra los avances diarios y mant√©n a tu equipo motivado con una vista m√°s amena y cercana.</p>
      <div class="banner-actions">
        <button type="button" class="primary"><i class="ri-fire-line"></i> Logros del d√≠a</button>
        <button type="button"><i class="ri-sparkling-2-line"></i> Recomendaciones r√°pidas</button>
      </div>
    </div>
    <div class="banner-illustration">
      <div class="celebration-tile">
        <span>üåº</span>
        <strong data-highlight-active="true">0</strong>
        <span>Animales activos brillando</span>
      </div>
      <div class="celebration-tile">
        <span>üíß</span>
        <strong data-highlight-weight="true">0 kg</strong>
        <span>Peso promedio balanceado</span>
      </div>
      <div class="celebration-tile">
        <span>üõ°Ô∏è</span>
        <strong data-highlight-health="true">0%</strong>
        <span>Salud estable en el reba√±o</span>
      </div>
    </div>
  </section>

  <div class="fun-strip">
    <div class="fun-message">
      <span>‚ú®</span>
      <p id="funMessageText">Hoy es un gran d√≠a para ver c√≥mo crecen tus logros.</p>
    </div>
    <button type="button" id="refreshMessage"><i class="ri-shuffle-line"></i> Cambiar mensaje</button>
  </div>

  <section class="stats-grid">
    <article class="stat-card">
      <header>
        <h3>Animales activos</h3>
        <i class="ri-cow-line"></i>
      </header>
      <strong data-stat="activos-total" data-counter-key="activos" data-counter-decimals="0">0</strong>
      <span class="stat-trend">
        <i class="ri-user-unfollow-line"></i>
        Inactivos:
        <strong data-stat="inactivos-total" data-counter-key="inactivos" data-counter-decimals="0">0</strong>
      </span>
    </article>
    <article class="stat-card">
      <header>
        <h3>En observaci√≥n</h3>
        <i class="ri-eye-line"></i>
      </header>
      <strong data-stat="observacion-total" data-counter-key="observacion" data-counter-decimals="0">0</strong>
      <span class="stat-trend"><i class="ri-stethoscope-line"></i> Casos que requieren seguimiento</span>
    </article>
    <article class="stat-card">
      <header>
        <h3>Requieren atenci√≥n</h3>
        <i class="ri-hospital-line"></i>
      </header>
      <strong data-stat="sick-total" data-counter-key="criticos" data-counter-decimals="0">0</strong>
      <span class="stat-trend"><i class="ri-alarm-warning-line"></i> Animales con intervenci√≥n pendiente</span>
    </article>
    <article class="stat-card">
      <header>
        <h3>Peso promedio</h3>
        <i class="ri-scales-3-line"></i>
      </header>
      <strong data-stat="peso-promedio" data-counter-key="pesoPromedio" data-counter-decimals="1" data-counter-suffix=" kg">0 kg</strong>
      <span class="stat-trend"><i class="ri-bar-chart-line"></i> Muestra del lote activo</span>
    </article>
    <article class="stat-card">
      <header>
        <h3>Tipos registrados</h3>
        <i class="ri-microscope-line"></i>
      </header>
      <strong data-stat="tipos-total" data-counter-key="tipos" data-counter-decimals="0">0</strong>
      <span class="stat-trend"><i class="ri-shape-line"></i>Diversidad zoosanitaria actual</span>
    </article>
  </section>

  <section class="milestones-grid">
    <article class="progress-card">
      <header><span>üíö</span> Salud sobresaliente</header>
      <p>Relaci√≥n de animales saludables frente al total controlado.</p>
      <div class="progress-bar">
        <span data-progress="healthy"></span>
      </div>
      <small data-progress-label="healthy">0%</small>
    </article>
    <article class="progress-card">
      <header><span>üëÄ</span> Observaciones atendidas</header>
      <p>Monitoriza el seguimiento de animales en observaci√≥n.</p>
      <div class="progress-bar">
        <span data-progress="observe"></span>
      </div>
      <small data-progress-label="observe">0%</small>
    </article>
    <article class="progress-card">
      <header><span>‚ö°</span> Disponibilidad activa</header>
      <p>Porcentaje de animales listos para producci√≥n o tareas.</p>
      <div class="progress-bar">
        <span data-progress="active"></span>
      </div>
      <small data-progress-label="active">0%</small>
    </article>
  </section>

  <section class="timeline-section">
    <h3><i class="ri-history-line"></i> Bit√°cora sanitaria reciente</h3>
    <div class="timeline">
      <div class="timeline-item">
        <header>
          <strong>VAC-002 ‚Ä¢ Tratamiento completado</strong>
          <span><i class="ri-time-line"></i> Hace 2 horas</span>
        </header>
        <p>Se complet√≥ el ciclo antibi√≥tico. Pr√≥xima evaluaci√≥n en 5 d√≠as.</p>
      </div>
      <div class="timeline-item">
        <header>
          <strong>Nuevos registros de peso</strong>
          <span><i class="ri-time-line"></i> Ayer</span>
        </header>
        <p>Actualizaci√≥n semanal de lotes A y B. Promedio general +3.4%.</p>
      </div>
      <div class="timeline-item">
        <header>
          <strong>Alertas de observaci√≥n</strong>
          <span><i class="ri-time-line"></i> Hace 3 d√≠as</span>
        </header>
        <p>Se asignaron seguimientos para 2 animales tras monitoreo en campo.</p>
      </div>
    </div>
  </section>

  <div class="quick-filters">
    <span>Filtros r√°pidos:</span>
    <div class="chips">
      <button type="button" data-chip="activos"><i class="ri-flashlight-line"></i> Solo activos</button>
      <button type="button" data-chip="healthy"><i class="ri-heart-pulse-line"></i> Saludables</button>
      <button type="button" data-chip="observe"><i class="ri-eye-2-line"></i> En observaci√≥n</button>
      <button type="button" data-chip="criticos"><i class="ri-alert-line"></i> Casos cr√≠ticos</button>
      <button type="button" data-chip="juveniles"><i class="ri-leaf-line"></i> Menores de 12 meses</button>
    </div>
  </div>

  <section class="analytics-section">
    <article class="chart-card">
      <header>
        <h4><i class="ri-pie-chart-line"></i> Estado sanitario</h4>
        <span>Distribuci√≥n actual por estado y disponibilidad</span>
      </header>
      <div class="chart-wrapper">
        <canvas id="healthChart"></canvas>
      </div>
      <div class="chart-legend" id="healthLegend"></div>
    </article>
    <article class="chart-card">
      <header>
        <h4><i class="ri-bar-chart-horizontal-line"></i> Tipos de ganado</h4>
        <span>Clasificaci√≥n por especie o prop√≥sito productivo</span>
      </header>
      <div class="chart-wrapper">
        <canvas id="typeChart"></canvas>
      </div>
      <div class="chart-legend" id="typeLegend"></div>
    </article>
  </section>

  <section class="filters-panel">
    <div>
      <label for="searchInput">Buscar animal</label>
      <input id="searchInput" type="text" placeholder="Ej: Bovino Holstein, Lote 3, C√≥digo...">
    </div>
    <div>
      <label for="filterTipo">Filtrar por tipo</label>
      <select id="filterTipo">
        <option value="all">Todos</option>
      </select>
    </div>
    <div>
      <label for="filterEstado">Estado sanitario</label>
      <select id="filterEstado">
        <option value="all">Todos</option>
        <option value="Saludable">Saludable</option>
        <option value="En observaci√≥n">En observaci√≥n</option>
        <option value="Enfermo">Enfermo</option>
      </select>
    </div>
    <div>
      <label for="filterActivo">Disponibilidad</label>
      <select id="filterActivo">
        <option value="all">Todos</option>
        <option value="true">Activos</option>
        <option value="false">Inactivos</option>
      </select>
    </div>
    <div>
      <label for="filterPeso">Peso m√≠nimo (kg)</label>
      <div class="range-wrapper">
        <input id="filterPeso" type="range" min="0" max="800" step="10" value="0">
        <span id="filterPesoValue">0 kg</span>
      </div>
    </div>
    <div class="filter-actions">
      <button type="button" class="primary" id="applyFilters"><i class="ri-filter-3-line"></i> Aplicar filtros</button>
      <button type="button" class="secondary" id="clearFilters"><i class="ri-refresh-line"></i> Limpiar</button>
    </div>
  </section>

  <section class="form-section" id="registroGanadoSection">
    <h3><i class="ri-cow-line"></i> Registrar nuevo ganado</h3>
    <form method="post" th:action="@{/admin/ganado/guardar}">
      <div class="form-grid">
        <div class="form-group">
          <label for="nuevo-tipo">Tipo</label>
          <input id="nuevo-tipo" type="text" name="tipo" placeholder="Ej: Bovino, Porcino" required>
        </div>
        <div class="form-group">
          <label for="nuevo-raza">Raza</label>
          <input id="nuevo-raza" type="text" name="raza" placeholder="Holstein, Yorkshire...">
        </div>
        <div class="form-group">
          <label for="nuevo-edad">Edad (meses)</label>
          <input id="nuevo-edad" type="number" name="edad" min="0" placeholder="Ej: 24">
        </div>
        <div class="form-group">
          <label for="nuevo-peso">Peso (kg)</label>
          <input id="nuevo-peso" type="number" name="peso" step="0.01" min="0" placeholder="Ej: 450.5">
        </div>
        <div class="form-group">
          <label for="nuevo-estado">Estado de salud</label>
          <select id="nuevo-estado" name="estadoSalud">
            <option value="Saludable">Saludable</option>
            <option value="En observaci√≥n">En observaci√≥n</option>
            <option value="Enfermo">Enfermo</option>
          </select>
        </div>
        <div class="form-group">
          <label for="nuevo-fecha">Fecha de nacimiento</label>
          <input id="nuevo-fecha" type="date" name="fechaNacimiento">
        </div>
      </div>
      <div class="form-actions">
        <button type="submit" class="submit"><i class="ri-check-line"></i> Guardar registro</button>
        <button type="reset" class="clear"><i class="ri-eraser-line"></i> Limpiar</button>
      </div>
    </form>
  </section>

  <section class="form-section edit-form" id="form-editar">
    <h3><i class="ri-edit-line"></i> Editar registro de ganado</h3>
    <form method="post" th:action="@{/admin/ganado/actualizar}">
      <input type="hidden" name="idGanado" id="edit-id">
      <div class="form-grid">
        <div class="form-group">
          <label for="edit-tipo">Tipo</label>
          <input type="text" name="tipo" id="edit-tipo" required>
        </div>
        <div class="form-group">
          <label for="edit-raza">Raza</label>
          <input type="text" name="raza" id="edit-raza">
        </div>
        <div class="form-group">
          <label for="edit-edad">Edad (meses)</label>
          <input type="number" name="edad" id="edit-edad" min="0">
        </div>
        <div class="form-group">
          <label for="edit-peso">Peso (kg)</label>
          <input type="number" name="peso" id="edit-peso" step="0.01" min="0">
        </div>
        <div class="form-group">
          <label for="edit-estado">Estado de salud</label>
          <select name="estadoSalud" id="edit-estado">
            <option value="Saludable">Saludable</option>
            <option value="En observaci√≥n">En observaci√≥n</option>
            <option value="Enfermo">Enfermo</option>
          </select>
        </div>
        <div class="form-group">
          <label for="edit-fechaNac">Fecha de nacimiento</label>
          <input type="date" name="fechaNacimiento" id="edit-fechaNac">
        </div>
        <div class="form-group">
          <label for="edit-activo">Disponibilidad</label>
          <select name="activo" id="edit-activo">
            <option value="true">Activo</option>
            <option value="false">Inactivo</option>
          </select>
        </div>
      </div>
      <div class="form-actions">
        <button type="submit" class="submit"><i class="ri-save-line"></i> Actualizar</button>
        <button type="button" class="clear" id="cancelEdit"><i class="ri-close-line"></i> Cancelar</button>
      </div>
    </form>
  </section>

  <section class="view-toggle">
    <div class="toggle-group">
      <button type="button" data-view="table" class="active"><i class="ri-table-line"></i> Vista tabla</button>
      <button type="button" data-view="cards"><i class="ri-layout-grid-line"></i> Vista tarjetas</button>
    </div>
    <div class="view-meta">
      <span><i class="ri-checkbox-circle-line" style="color: var(--verde-med);"></i> Controla la disponibilidad en tiempo real</span>
    </div>
  </section>

  <section class="table-wrapper" id="tableView">
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Tipo</th>
          <th>Raza</th>
          <th>Edad (meses)</th>
          <th>Peso (kg)</th>
          <th>Estado sanitario</th>
          <th>Disponibilidad</th>
          <th>Fecha nacimiento</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody id="ganadoTableBody">
        <tr th:each="g : ${ganado}"
            th:data-id="${g.idGanado}"
            th:data-tipo="${g.tipo}"
            th:data-raza="${g.raza}"
            th:data-edad="${g.edad}"
            th:data-peso="${g.peso}"
            th:data-estado="${g.estadoSalud}"
            th:data-fecha="${g.fechaNacimiento}"
            th:data-activo="${g.activo != null ? g.activo : true}">
          <td>
            <div class="badge" th:classappend="${g.activo} ? '' : ' inactive'">
              <i class="ri-cow-line"></i>
              <span th:text="${g.idGanado}">1</span>
            </div>
          </td>
          <td th:text="${g.tipo}">Tipo</td>
          <td th:text="${g.raza} ?: '‚Äî'">Raza</td>
          <td th:text="${g.edad} ?: '‚Äî'">0</td>
          <td th:text="${g.peso != null} ? #numbers.formatDecimal(g.peso, 1, 'POINT', 2, 'COMMA') + ' kg' : '‚Äî'">0 kg</td>
          <td>
            <span class="health-tag"
                  th:classappend="${g.estadoSalud} == 'Saludable' ? ' healthy' :
                                  (${g.estadoSalud} == 'En observaci√≥n' ? ' observe' : ' sick')}"
                  th:text="${g.estadoSalud} ?: 'No definido'">Saludable</span>
          </td>
          <td>
            <span class="badge" th:classappend="${g.activo} ? '' : ' inactive'"
                  th:text="${g.activo} ? 'Activo' : 'Inactivo'">Activo</span>
          </td>
          <td th:text="${g.fechaNacimiento} ?: '‚Äî'">2025-01-01</td>
          <td class="actions">
            <button type="button" class="edit"><i class="ri-edit-line"></i> Editar</button>
            <button type="button" class="toggle" th:classappend="${g.activo} ? '' : ' inactive'">
              <i class="ri-refresh-line"></i>
              <span th:text="${g.activo} ? 'Desactivar' : 'Activar'">Desactivar</span>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </section>

  <section id="cardView" class="card-grid hidden">
    <article class="animal-card"
             th:each="g : ${ganado}"
             th:data-card-id="${g.idGanado}"
             th:data-id="${g.idGanado}"
             th:data-tipo="${g.tipo}"
             th:data-raza="${g.raza}"
             th:data-edad="${g.edad}"
             th:data-peso="${g.peso}"
             th:data-estado="${g.estadoSalud}"
             th:data-fecha="${g.fechaNacimiento}"
             th:data-activo="${g.activo != null ? g.activo : true}">
      <header>
        <h5><i class="ri-cow-line"></i><span th:text="${g.tipo}">Tipo</span></h5>
        <span class="badge" th:classappend="${g.activo} ? '' : ' inactive'" th:text="${g.activo} ? 'Activo' : 'Inactivo'">Activo</span>
      </header>
      <div class="meta">
        <span><i class="ri-hashtag"></i>ID&nbsp;<strong th:text="${g.idGanado}">1</strong></span>
        <span><i class="ri-git-branch-line"></i><span th:text="${g.raza} ?: '‚Äî'">Raza</span></span>
        <span><i class="ri-timer-line"></i><span th:text="${g.edad} != null ? g.edad + ' meses' : '‚Äî'">0 meses</span></span>
        <span><i class="ri-scales-2-line"></i><span th:text="${g.peso != null} ? #numbers.formatDecimal(g.peso, 1, 'POINT', 2, 'COMMA') + ' kg' : '‚Äî'">0 kg</span></span>
        <span><i class="ri-calendar-line"></i><span th:text="${g.fechaNacimiento} ?: '‚Äî'">2025-01-01</span></span>
      </div>
      <div class="footer">
        <div class="state">
          <span class="health-tag"
                th:classappend="${g.estadoSalud} == 'Saludable' ? ' healthy' :
                                (${g.estadoSalud} == 'En observaci√≥n' ? ' observe' : ' sick')"
                th:text="${g.estadoSalud} ?: 'No definido'">Saludable</span>
        </div>
        <div class="actions">
          <button type="button" class="edit"><i class="ri-edit-line"></i> Editar</button>
          <button type="button" class="toggle" th:classappend="${g.activo} ? '' : ' inactive'">
            <i class="ri-refresh-line"></i>
            <span th:text="${g.activo} ? 'Desactivar' : 'Activar'">Desactivar</span>
          </button>
        </div>
      </div>
    </article>
  </section>

  <section class="secondary-section">
    <article class="secondary-card">
      <h4><i class="ri-calendar-event-line"></i> Actividades pendientes</h4>
      <div class="list-items">
        <div class="list-item">
          <span>Vacunaci√≥n bovinos lote B</span>
          <span class="mini-badge">Ma√±ana 08:00</span>
        </div>
        <div class="list-item">
          <span>An√°lisis de peso semanal</span>
          <span class="mini-badge">Viernes</span>
        </div>
        <div class="list-item">
          <span>Chequeo veterinario integral</span>
          <span class="mini-badge">En 3 d√≠as</span>
        </div>
      </div>
    </article>

    <article class="secondary-card">
      <h4><i class="ri-temp-cold-line"></i> Indicadores ambientales</h4>
      <div class="list-items">
        <div class="list-item">
          <span>Temperatura establo</span>
          <span class="mini-badge">21¬∞C</span>
        </div>
        <div class="list-item">
          <span>Humedad relativa</span>
          <span class="mini-badge">68%</span>
        </div>
        <div class="list-item">
          <span>Ventilaci√≥n requerida</span>
          <span class="mini-badge">Nivel medio</span>
        </div>
      </div>
    </article>

    <article class="secondary-card">
      <h4><i class="ri-heart-pulse-line"></i> Recomendaciones</h4>
      <div class="list-items">
        <div class="list-item">
          <span>Registrar evoluci√≥n de casos observados</span>
          <span class="mini-badge">Diario</span>
        </div>
        <div class="list-item">
          <span>Programar desparasitaci√≥n trimestral</span>
          <span class="mini-badge">Programar</span>
        </div>
        <div class="list-item">
          <span>Actualizar cat√°logo de razas y cruces</span>
          <span class="mini-badge">An√°lisis</span>
        </div>
      </div>
    </article>
  </section>
</main>
<script>
  const tableBody = document.getElementById('ganadoTableBody');
  const tableView = document.getElementById('tableView');
  const cardContainer = document.getElementById('cardView');
  const searchInput = document.getElementById('searchInput');
  const filterTipo = document.getElementById('filterTipo');
  const filterEstado = document.getElementById('filterEstado');
  const filterActivo = document.getElementById('filterActivo');
  const filterPeso = document.getElementById('filterPeso');
  const filterPesoValue = document.getElementById('filterPesoValue');
  const applyButton = document.getElementById('applyFilters');
  const clearButton = document.getElementById('clearFilters');
  const quickFilterButtons = Array.from(document.querySelectorAll('.quick-filters button'));
  const viewButtons = document.querySelectorAll('[data-view]');
  const counterElements = {};
  const highlightActive = document.querySelector('[data-highlight-active]');
  const highlightWeight = document.querySelector('[data-highlight-weight]');
  const highlightHealth = document.querySelector('[data-highlight-health]');
  const progressBars = {
    healthy: document.querySelector('[data-progress="healthy"]'),
    observe: document.querySelector('[data-progress="observe"]'),
    active: document.querySelector('[data-progress="active"]')
  };
  const progressLabels = {
    healthy: document.querySelector('[data-progress-label="healthy"]'),
    observe: document.querySelector('[data-progress-label="observe"]'),
    active: document.querySelector('[data-progress-label="active"]')
  };
  const funMessageText = document.getElementById('funMessageText');
  const funMessageButton = document.getElementById('refreshMessage');
  const funMessages = [
    stats => `Hoy ${stats.activeCount} animales est√°n activos y listos para brillar.`,
    stats => `ü•õ Peso promedio de ${stats.averageWeight.toFixed(1)} kg. ¬°Rutina equilibrada!`,
    stats => `üå± ${stats.distinctTypes} tipos diferentes: diversidad que inspira.`,
    stats => stats.healthyShare >= 75
      ? `üíö Salud a tope: ${stats.healthyShare.toFixed(0)}% del lote se ve genial.`
      : `üëÄ Mantente alerta: ${stats.observationShare.toFixed(0)}% requieren cari√±o extra.`,
    stats => stats.activeCount > stats.inactiveCount
      ? `‚ö° Energ√≠a positiva: m√°s animales activos que inactivos.`
      : `üå¨Ô∏è Tiempo de reactivar: dale seguimiento a los inactivos.`
  ];
  let funMessageIndex = 0;

  document.querySelectorAll('[data-counter-key]').forEach(element => {
    const key = element.dataset.counterKey;
    counterElements[key] = element;
    element.dataset.currentValue = parseNumber(element.textContent);
  });

  const cardMap = new Map();
  Array.from(cardContainer.querySelectorAll('.animal-card')).forEach(card => {
    const key = card.dataset.id || card.dataset.cardId;
    if (key) {
      cardMap.set(String(key), card);
    }
  });

  let activeQuickFilter = null;
  let healthChart;
  let typeChart;

  const healthPalette = ['#2d8659', '#ffc107', '#dc3545', '#6c757d'];
  const typePalette = ['#1a7a5e', '#2d8659', '#3fa06f', '#45b87a', '#51c97f', '#5dd68a', '#63e395', '#6ef0a0'];

  function rows() {
    return Array.from(tableBody.querySelectorAll('tr'));
  }

  function parseNumber(value) {
    if (typeof value === 'number') return value;
    if (!value) return 0;
    const normalized = value.toString().replace(/[^\d,.-]/g, '').replace(',', '.');
    const numeric = parseFloat(normalized);
    return Number.isNaN(numeric) ? 0 : numeric;
  }

  function parseDatasetNumber(value) {
    if (!value || value === 'null') return null;
    const numeric = parseFloat(value.toString().replace(',', '.'));
    return Number.isNaN(numeric) ? null : numeric;
  }

  function parseDatasetInt(value) {
    if (!value || value === 'null') return null;
    const numeric = parseInt(value, 10);
    return Number.isNaN(numeric) ? null : numeric;
  }

  function normalize(text) {
    return text ? text.toString().normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase() : '';
  }

  function animateValue(element, from, to, decimals, suffix) {
    const duration = 680;
    const startTime = performance.now();
    function frame(currentTime) {
      const progress = Math.min((currentTime - startTime) / duration, 1);
      const eased = 1 - Math.pow(1 - progress, 3);
      const value = from + (to - from) * eased;
      element.textContent = value.toLocaleString('es-ES', {
        minimumFractionDigits: decimals,
        maximumFractionDigits: decimals
      }) + suffix;
      if (progress < 1) {
        requestAnimationFrame(frame);
      } else {
        element.dataset.currentValue = to;
      }
    }
    requestAnimationFrame(frame);
  }

  function updateCounter(key, value) {
    const element = counterElements[key];
    if (!element) return;
    const decimals = parseInt(element.dataset.counterDecimals || '0', 10);
    const suffix = element.dataset.counterSuffix || '';
    const current = Number(element.dataset.currentValue ?? 0);
    if (Math.abs(current - value) < (1 / Math.pow(10, decimals + 1))) {
      element.textContent = value.toLocaleString('es-ES', {
        minimumFractionDigits: decimals,
        maximumFractionDigits: decimals
      }) + suffix;
      element.dataset.currentValue = value;
      return;
    }
    animateValue(element, current, value, decimals, suffix);
  }

  function gatherStats() {
    const dataRows = rows();
    const stats = {
      total: dataRows.length,
      activeCount: 0,
      inactiveCount: 0,
      observationCount: 0,
      sickCount: 0,
      healthyCount: 0,
      averageWeight: 0,
      maxWeight: 0,
      distinctTypes: 0,
      typeDistribution: {},
      healthDistribution: {
        'Saludable': 0,
        'En observaci√≥n': 0,
        'Enfermo': 0
      }
    };

    const weights = [];

    dataRows.forEach(row => {
      const dataset = row.dataset;
      const type = dataset.tipo && dataset.tipo.trim() ? dataset.tipo : 'Sin clasificar';
      stats.typeDistribution[type] = (stats.typeDistribution[type] || 0) + 1;

      const isActive = dataset.activo !== 'false';
      if (isActive) {
        stats.activeCount++;
      } else {
        stats.inactiveCount++;
      }

      const estadoNormalized = normalize(dataset.estado);
      if (estadoNormalized === 'saludable') {
        stats.healthyCount++;
        stats.healthDistribution['Saludable']++;
      } else if (estadoNormalized === 'en observacion') {
        stats.observationCount++;
        stats.healthDistribution['En observaci√≥n']++;
      } else if (estadoNormalized === 'enfermo') {
        stats.sickCount++;
        stats.healthDistribution['Enfermo']++;
      }

      const weight = parseDatasetNumber(dataset.peso);
      if (weight !== null) {
        weights.push(weight);
        if (weight > stats.maxWeight) {
          stats.maxWeight = weight;
        }
      }
    });

    stats.distinctTypes = Object.keys(stats.typeDistribution).length;
    stats.averageWeight = weights.length ? weights.reduce((acc, value) => acc + value, 0) / weights.length : 0;
    stats.healthyShare = stats.total ? (stats.healthyCount / stats.total) * 100 : 0;
    stats.observationShare = stats.total ? (stats.observationCount / stats.total) * 100 : 0;
    stats.activeShare = stats.total ? (stats.activeCount / stats.total) * 100 : 0;

    return stats;
  }

  function populateFilters(stats) {
    const previousTipo = filterTipo.value;
    filterTipo.innerHTML = '<option value="all">Todos</option>';

    Object.keys(stats.typeDistribution).sort().forEach(tipo => {
      const option = document.createElement('option');
      option.value = tipo;
      option.textContent = tipo;
      filterTipo.appendChild(option);
    });

    if (stats.typeDistribution[previousTipo]) {
      filterTipo.value = previousTipo;
    } else {
      filterTipo.value = 'all';
    }

    if (filterPeso && filterPesoValue) {
      const sliderMax = Math.max(100, Math.ceil((stats.maxWeight || 0) / 10) * 10);
      filterPeso.max = sliderMax;
      if (Number(filterPeso.value) > sliderMax) {
        filterPeso.value = sliderMax;
      }
      filterPesoValue.textContent = `${filterPeso.value} kg`;
    }
  }

  function updateCharts(stats) {
    const healthCanvas = document.getElementById('healthChart');
    const typeCanvas = document.getElementById('typeChart');

    if (healthCanvas) {
      const healthData = [
        stats.healthDistribution['Saludable'],
        stats.healthDistribution['En observaci√≥n'],
        stats.healthDistribution['Enfermo'],
        stats.inactiveCount
      ];
      const healthLabels = ['Saludable', 'En observaci√≥n', 'Enfermo', 'Inactivos'];

      if (!healthChart) {
        healthChart = new Chart(healthCanvas, {
          type: 'doughnut',
          data: {
            labels: healthLabels,
            datasets: [{
              data: healthData,
              backgroundColor: healthPalette,
              borderWidth: 0,
              hoverOffset: 8
            }]
          },
          options: {
            plugins: {
              legend: { display: false },
              tooltip: { backgroundColor: '#1f2d2a', padding: 12 }
            },
            cutout: '55%'
          }
        });
      } else {
        healthChart.data.datasets[0].data = healthData;
        healthChart.update();
      }

      const healthLegend = document.getElementById('healthLegend');
      if (healthLegend) {
        healthLegend.innerHTML = healthLabels.map((label, index) =>
          `<span><i style="background:${healthPalette[index]}"></i>${label}: ${healthData[index]}</span>`
        ).join('');
      }
    } else if (healthChart) {
      healthChart.destroy();
      healthChart = null;
    }

    if (typeCanvas) {
      const typeLabels = Object.keys(stats.typeDistribution).length
        ? Object.keys(stats.typeDistribution)
        : ['Sin registros'];
      const typeValues = Object.keys(stats.typeDistribution).length
        ? Object.values(stats.typeDistribution)
        : [0];
      const colors = typeLabels.map((_, index) => typePalette[index % typePalette.length]);

      if (!typeChart) {
        typeChart = new Chart(typeCanvas, {
          type: 'bar',
          data: {
            labels: typeLabels,
            datasets: [{
              data: typeValues,
              backgroundColor: colors,
              borderRadius: 10,
              maxBarThickness: 38
            }]
          },
          options: {
            plugins: {
              legend: { display: false },
              tooltip: { backgroundColor: '#1f2d2a', padding: 12 }
            },
            scales: {
              y: { beginAtZero: true, ticks: { precision: 0 } },
              x: { grid: { display: false } }
            }
          }
        });
      } else {
        typeChart.data.labels = typeLabels;
        typeChart.data.datasets[0].data = typeValues;
        typeChart.data.datasets[0].backgroundColor = colors;
        typeChart.update();
      }

      const typeLegend = document.getElementById('typeLegend');
      if (typeLegend) {
        typeLegend.innerHTML = typeLabels.map((label, index) =>
          `<span><i style="background:${colors[index]}"></i>${label}: ${typeValues[index]}</span>`
        ).join('');
      }
    } else if (typeChart) {
      typeChart.destroy();
      typeChart = null;
    }
  }

  function updateHighlights(stats) {
    if (highlightActive) {
      highlightActive.textContent = stats.activeCount.toLocaleString('es-ES');
    }
    if (highlightWeight) {
      highlightWeight.textContent = `${stats.averageWeight.toLocaleString('es-ES', { minimumFractionDigits: 1, maximumFractionDigits: 1 })} kg`;
    }
    if (highlightHealth) {
      highlightHealth.textContent = `${Math.round(stats.healthyShare)}%`;
    }
  }

  function updateProgressBars(stats) {
    const clamp = value => Math.max(0, Math.min(100, value));
    const updateBar = (key, value) => {
      const bar = progressBars[key];
      const label = progressLabels[key];
      if (!bar || !label) return;
      const percent = clamp(value);
      bar.style.width = `${percent}%`;
      label.textContent = `${percent.toFixed(0)}%`;
    };

    updateBar('healthy', stats.healthyShare);
    updateBar('observe', stats.observationShare);
    updateBar('active', stats.activeShare);
  }

  function renderFunMessage(index, stats) {
    if (!funMessageText || !funMessages.length) return;
    const messageFn = funMessages[index % funMessages.length] || funMessages[0];
    funMessageText.textContent = messageFn(stats);
  }

  function updateStatistics() {
    const stats = gatherStats();
    updateCounter('activos', stats.activeCount);
    updateCounter('inactivos', stats.inactiveCount);
    updateCounter('observacion', stats.observationCount);
    updateCounter('criticos', stats.sickCount);
    updateCounter('pesoPromedio', Number(stats.averageWeight.toFixed(1)));
    updateCounter('tipos', stats.distinctTypes);
    updateHighlights(stats);
    updateProgressBars(stats);
    renderFunMessage(funMessageIndex, stats);
    populateFilters(stats);
    updateCharts(stats);
  }

  function resetQuickFilters() {
    activeQuickFilter = null;
    quickFilterButtons.forEach(btn => btn.classList.remove('active'));
  }

  function handleQuickFilter(chip) {
    if (activeQuickFilter === chip) {
      resetQuickFilters();
      if (chip === 'activos') {
        filterActivo.value = 'all';
      }
      if (chip === 'healthy' || chip === 'observe' || chip === 'criticos') {
        filterEstado.value = 'all';
      }
    } else {
      resetQuickFilters();
      activeQuickFilter = chip;
      quickFilterButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.chip === chip));
      if (chip === 'activos') {
        filterActivo.value = 'true';
      } else if (chip === 'healthy') {
        filterEstado.value = 'Saludable';
      } else if (chip === 'observe') {
        filterEstado.value = 'En observaci√≥n';
      } else if (chip === 'criticos') {
        filterEstado.value = 'Enfermo';
      } else if (chip === 'juveniles') {
        if (filterPeso) {
          filterPeso.value = filterPeso.min || 0;
          if (filterPesoValue) {
            filterPesoValue.textContent = `${filterPeso.value} kg`;
          }
        }
      }
    }
    applyFilters();
  }

  function syncQuickFilterState() {
    if (!activeQuickFilter) return;
    if (activeQuickFilter === 'activos' && filterActivo.value !== 'true') {
      resetQuickFilters();
    } else if (activeQuickFilter === 'healthy' && filterEstado.value !== 'Saludable') {
      resetQuickFilters();
    } else if (activeQuickFilter === 'observe' && filterEstado.value !== 'En observaci√≥n') {
      resetQuickFilters();
    } else if (activeQuickFilter === 'criticos' && filterEstado.value !== 'Enfermo') {
      resetQuickFilters();
    }
  }

  function applyFilters() {
    const searchValue = normalize(searchInput.value.trim());
    const tipoValue = filterTipo.value;
    const estadoValue = normalize(filterEstado.value);
    const activoValue = filterActivo.value;
    const pesoMin = filterPeso ? Number(filterPeso.value) : 0;
    const requiresJuveniles = activeQuickFilter === 'juveniles';

    rows().forEach(row => {
      const dataset = row.dataset;
      const tipoDataset = dataset.tipo && dataset.tipo.trim() ? dataset.tipo : 'Sin clasificar';
      const searchTarget = normalize(`${tipoDataset} ${dataset.raza || ''} ${dataset.id || ''}`);
      const matchesSearch = !searchValue || searchTarget.includes(searchValue);
      const matchesTipo = tipoValue === 'all' || tipoDataset === tipoValue;
      const estadoNormalized = normalize(dataset.estado);
      const matchesEstado = filterEstado.value === 'all' || estadoNormalized === estadoValue;
      const isActive = dataset.activo !== 'false';
      const matchesActivo = activoValue === 'all' || (activoValue === 'true' ? isActive : !isActive);
      const weight = parseDatasetNumber(dataset.peso);
      const matchesPeso = !pesoMin || (weight !== null && weight >= pesoMin);
      const edad = parseDatasetInt(dataset.edad);
      const matchesJuveniles = !requiresJuveniles || (edad !== null && edad < 12);
      const matches = matchesSearch && matchesTipo && matchesEstado && matchesActivo && matchesPeso && matchesJuveniles;
      row.style.display = matches ? '' : 'none';
      const card = cardMap.get(String(dataset.id));
      if (card) {
        card.classList.toggle('hidden', !matches);
      }
    });
  }

  function openEditForm(data) {
    const formSection = document.getElementById('form-editar');
    formSection.style.display = 'block';
    const safe = value => (value && value !== 'null') ? value : '';
    document.getElementById('edit-id').value = safe(data.id);
    document.getElementById('edit-tipo').value = safe(data.tipo);
    document.getElementById('edit-raza').value = safe(data.raza);
    document.getElementById('edit-edad').value = safe(data.edad);
    document.getElementById('edit-peso').value = safe(data.peso);
    document.getElementById('edit-estado').value = safe(data.estado) || 'Saludable';
    document.getElementById('edit-fechaNac').value = safe(data.fecha);
    document.getElementById('edit-activo').value = data.activo === 'false' ? 'false' : 'true';
    formSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  function closeEditForm() {
    const formSection = document.getElementById('form-editar');
    formSection.style.display = 'none';
    formSection.querySelector('form').reset();
  }

  function updateRowVisualState(rowElement, isActive) {
    if (!rowElement) return;
    rowElement.dataset.activo = String(isActive);
    const availabilityBadge = rowElement.querySelector('td:nth-child(7) .badge');
    const toggleButton = rowElement.querySelector('.actions .toggle');
    const toggleText = toggleButton ? toggleButton.querySelector('span') : null;

    if (availabilityBadge) {
      availabilityBadge.textContent = isActive ? 'Activo' : 'Inactivo';
      availabilityBadge.classList.toggle('inactive', !isActive);
    }

    if (toggleButton && toggleText) {
      toggleButton.classList.toggle('inactive', !isActive);
      toggleButton.disabled = false;
      toggleText.textContent = isActive ? 'Desactivar' : 'Activar';
    }
  }

  function updateCardVisualState(cardElement, isActive) {
    if (!cardElement) return;
    cardElement.dataset.activo = String(isActive);
    const badge = cardElement.querySelector('.badge');
    const toggleButton = cardElement.querySelector('.actions .toggle');
    const toggleText = toggleButton ? toggleButton.querySelector('span') : null;

    if (badge) {
      badge.textContent = isActive ? 'Activo' : 'Inactivo';
      badge.classList.toggle('inactive', !isActive);
    }

    if (toggleButton && toggleText) {
      toggleButton.classList.toggle('inactive', !isActive);
      toggleButton.disabled = false;
      toggleText.textContent = isActive ? 'Desactivar' : 'Activar';
    }
  }

  function handleToggle(id, triggerButton) {
    if (!id) return;
    const rowElement = tableBody.querySelector(`tr[data-id="${id}"]`);
    const cardElement = cardMap.get(String(id));
    const isActive = rowElement ? rowElement.dataset.activo !== 'false' : (cardElement ? cardElement.dataset.activo !== 'false' : true);
    const nextState = !isActive;
    const toggleLabel = triggerButton ? triggerButton.querySelector('span') : null;
    const originalText = toggleLabel ? toggleLabel.textContent : '';

    if (triggerButton) {
      triggerButton.disabled = true;
      if (toggleLabel) toggleLabel.textContent = 'Actualizando...';
    }

    fetch(`/admin/ganado/estado/${id}?activo=${nextState}`, { method: 'POST' })
      .then(res => res.json())
      .then(response => {
        if (response.status === 'ok') {
          updateRowVisualState(rowElement, nextState);
          updateCardVisualState(cardElement, nextState);
          if (triggerButton) triggerButton.disabled = false;
          updateStatistics();
          applyFilters();
        } else {
          throw new Error();
        }
      })
      .catch(() => {
        alert('No se pudo actualizar el estado. Intente nuevamente.');
        if (triggerButton) {
          triggerButton.disabled = false;
          if (toggleLabel) toggleLabel.textContent = originalText || (isActive ? 'Desactivar' : 'Activar');
        }
      });
  }

  tableBody.addEventListener('click', event => {
    const button = event.target.closest('button');
    if (!button) return;
    const row = event.target.closest('tr');
    if (!row) return;
    if (button.classList.contains('edit')) {
      openEditForm(row.dataset);
    } else if (button.classList.contains('toggle')) {
      handleToggle(row.dataset.id, button);
    }
  });

  cardContainer.addEventListener('click', event => {
    const button = event.target.closest('button');
    if (!button) return;
    const card = event.target.closest('.animal-card');
    if (!card) return;
    if (button.classList.contains('edit')) {
      openEditForm(card.dataset);
    } else if (button.classList.contains('toggle')) {
      handleToggle(card.dataset.id, button);
    }
  });

  quickFilterButtons.forEach(btn => {
    btn.addEventListener('click', () => handleQuickFilter(btn.dataset.chip));
  });

  viewButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      if (btn.classList.contains('active')) return;
      viewButtons.forEach(button => button.classList.remove('active'));
      btn.classList.add('active');
      if (btn.dataset.view === 'cards') {
        tableView.classList.add('hidden');
        cardContainer.classList.remove('hidden');
      } else {
        cardContainer.classList.add('hidden');
        tableView.classList.remove('hidden');
      }
    });
  });

  if (filterPeso) {
    filterPeso.addEventListener('input', () => {
      if (filterPesoValue) {
        filterPesoValue.textContent = `${filterPeso.value} kg`;
      }
    });
    filterPeso.addEventListener('change', applyFilters);
  }

  applyButton.addEventListener('click', () => {
    applyFilters();
  });

  clearButton.addEventListener('click', () => {
    searchInput.value = '';
    filterTipo.value = 'all';
    filterEstado.value = 'all';
    filterActivo.value = 'all';
    if (filterPeso) {
      filterPeso.value = filterPeso.min || 0;
      if (filterPesoValue) {
        filterPesoValue.textContent = `${filterPeso.value} kg`;
      }
    }
    resetQuickFilters();
    applyFilters();
  });

  searchInput.addEventListener('input', () => applyFilters());
  filterTipo.addEventListener('change', () => applyFilters());
  filterEstado.addEventListener('change', () => {
    syncQuickFilterState();
    applyFilters();
  });
  filterActivo.addEventListener('change', () => {
    syncQuickFilterState();
    applyFilters();
  });

  if (funMessageButton) {
    funMessageButton.addEventListener('click', () => {
      funMessageIndex = (funMessageIndex + 1) % funMessages.length;
      renderFunMessage(funMessageIndex, gatherStats());
    });
  }

  document.getElementById('cancelEdit').addEventListener('click', closeEditForm);
  document.getElementById('scrollToForm').addEventListener('click', () => {
    document.getElementById('registroGanadoSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
  });

  updateStatistics();
  applyFilters();
</script>
</body>
</html>
